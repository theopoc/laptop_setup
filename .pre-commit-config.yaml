---
# Pre-commit hooks for Ansible playbook repository
# Install: pre-commit install
# Run manually: pre-commit run --all-files
# Update hooks: pre-commit autoupdate

repos:
  # YAML linting
  # - repo: https://github.com/adrienverge/yamllint
  #   rev: v1.37.1
  #   hooks:
  #     - id: yamllint
  #       args: [-c=.yamllint]
  #       files: \.(yaml|yml)$

  # # Ansible linting
  # - repo: https://github.com/ansible/ansible-lint
  #   rev: v25.9.2
  #   hooks:
  #     - id: ansible-lint

  # Security - Check for secrets
  # - repo: https://github.com/Yelp/detect-secrets
  #   rev: v1.5.0
  #   hooks:
  #     - id: detect-secrets
  #       args: ["--baseline", ".secrets.baseline"]

  # Commit message format
  - repo: https://github.com/compilerla/conventional-pre-commit
    rev: v4.3.0
    hooks:
      - id: conventional-pre-commit
        stages: [commit-msg]

  - repo: https://github.com/oxsecurity/megalinter
    rev: v9.2.0 # Git tag specifying the hook, not mega-linter-runner, version
    hooks:
      - id: megalinter-incremental # Faster, less thorough
        entry: npx --
        args:
          - mega-linter-runner
          - "--fix"
          - --env
          - "'FILTER_REGEX_EXCLUDE=(.specify)'"
          - "--no-remove-container"
          - "-f"
          - "documentation"

        stages:
          - pre-commit
