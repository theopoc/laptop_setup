---
# tasks file for roles/gpg

- name: Include OS-specific variables
  ansible.builtin.include_vars: "{{ lookup('ansible.builtin.first_found', params) }}"
  vars:
    params:
      files:
        - "{{ ansible_facts.os_family }}.yml"
        - "main.yml"
      paths:
        - "vars"
  tags: gpg

- name: Install GPG using Debian specific tasks
  ansible.builtin.include_tasks: "install-Debian.yml"
  when: ansible_facts.distribution == "Debian"
  tags: gpg

- name: Install GPG using Ubuntu specific tasks
  ansible.builtin.include_tasks: "install-Ubuntu.yml"
  when: ansible_facts.distribution == "Ubuntu"
  tags: gpg

- name: Configure GPG using OS-specific tasks
  ansible.builtin.include_tasks: "{{ lookup('ansible.builtin.first_found', params) }}"
  vars:
    params:
      files:
        - "setup-{{ ansible_facts.os_family }}.yml"
        - "setup.yml"
      paths:
        - "tasks"
  when: gpg_enabled | bool
  tags: gpg
